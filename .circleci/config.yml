version: 2.1

orbs:
  sedstart: shinobi/cicd@dev:one

jobs:
  run-sedstart-cloud:
    docker:
      - image: cimg/node:20.18.0
    steps:
      - run:
          name: "Debug: show env"
          command: |
            echo "Testing sedstart-shinobi orb (dev)"

      - sedstart/runcloud:
          api_key: SEDSTART_API_KEY
          project_id: 364
          test_id: 1629
          profile_id: 616
          browser: "chrome"
          environment: "QA"
  run-sedstart-local:
    docker:
      - image: cimg/base:stable
    steps:
      - checkout
      - run:
          name: Install Xvfb
          command: |
            sudo apt-get update
            sudo apt-get install -y xvfb
            sudo npx playwright install-deps firefox

      - sedstart/runlocal:
          api_key: SEDSTART_API_KEY 
          project_id: 364
          test_id: 1629
          profile_id: 616
          browser: "safari"
          environment: "QA"

workflows:
  main:
    jobs:
      - run-sedstart-local
