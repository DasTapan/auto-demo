version: 2.1

orbs:
   cicd: sedstart/cicd@dev:1

jobs:
  run-sedstart-cloud:
    docker:
      - image: cimg/node:20.18.0
    steps:
      - run:
          name: "Debug: show env"
          command: |
            echo "Testing sedstart-shinobi orb (dev)"
      - cicd/runlocal:
          api_key: SEDSTART_API_KEY
          project_id: 364
          test_id: 1629
          profile_id: 616
          environment: "QA"
          
  run-sedstart-local-linux:
    docker:
      - image: cimg/node:20.18.0
    steps:
      - checkout
      - run:
          name: "Install Playwright"
          command: |
            sudo apt-get update
            sudo apt-get install -y xvfb
      - cicd/runlocal:
          api_key: SEDSTART_API_KEY 
          project_id: 418
          test_id: 1937
          profile_id: 848
          browser: "firefox"
          environment: "QA"
          
  run-sedstart-local-windows:
    resource_class: 'windows.medium'
    machine:
      image: "windows-server-2022-gui:current"
      shell: "powershell.exe -ExecutionPolicy Bypass"
    steps:
      - checkout
      - cicd/runlocal:
          api_key: SEDSTART_API_KEY
          project_id: 418
          test_id: 1937
          profile_id: 848
          browser: 'msedge'
          environment: "QA"
          
  run-sedstart-local-mac:
    macos:
      xcode: 16.4.0
      resource_class: 'm4pro.medium'
    steps:
      - checkout
      - cicd/runlocal:
          api_key: SEDSTART_API_KEY
          project_id: 418
          test_id: 1937
          profile_id: 848
          environment: "QA"
          browser: "webkit"

workflows:
  main:
    jobs:
      - run-sedstart-local-windows
